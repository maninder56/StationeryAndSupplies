@page "{parentCategory}/{childCategory?}"
@model ProductsListPageModel

@{
    ViewData["Title"] = "Products";

    int nextPageNumber = Model.CurrentPageNumber + 1;
    int previousPageNumber = Model.CurrentPageNumber - 1; 

}

<article class="product-list-page">
    <section class="section-container">
        <div class="category-title-and-orderby-section">
            <div class="category-title">@Model.CategoryName</div>
            <div class="order-by-container">
                <div class="order-by-title">
                    <header>Order By : </header>
                </div>
                <div class="drop-down">
                    <form method="get" id="order-by-drop-down-form"
                    asp-page="/ProductsListPage"
                    asp-route-parentCategory="@Model.ParentCategoryName"
                    asp-route-childCategory="@Model.ChildCategoryName">
                        <select asp-for="Input.OrderByOptionsSelectedValue" 
                        asp-items="Model.SortOptions" 
                        id="order-by-drop-down" class="order-by-drop-down-select">
                        </select>
                    </form>
                </div>
            </div>
        </div>

        <div class="product-list-contaienr">
            <div class="product-list">
                @foreach(var product in Model.ProductList)
                {
                    <div class="product-container">
                        <div class="product-link-container">
                            @* Link to single product details *@
                            <a asp-page="/SingleProductPage"
                            asp-route-productname="@product.Name.Replace(' ', '-')"
                            asp-route-productid="@product.Id"
                            class="product-link">
                                @if(product.ImageUrl is null)
                                {
                                    <div class="image-container">
                                        <img src="~/images/products/PlaceholderForMissingImages.svg" alt="placeholder image" />
                                    </div>
                                }
                                else
                                {
                                    <div class="image-container">
                                        <img src="~/@product.ImageUrl" alt="@product.Name image" />
                                    </div>
                                }
                            </a>
                        </div>
                        <div class="product-details-container">
                            <div class="product-details">
                                <div class="product-name">@product.Name</div>
                                <div class="product-price">£@product.Price</div>
                            </div>
                            @if(!product.InStock)
                            {
                                <div class="out-of-stock">Out of Stock</div>
                            }
                        </div>
                    </div>
                }
            </div>
        </div>

        <div class="page-navigation-container">
            <div class="page-navigatoin-section">
                <div class="page-navigatoin">
                    @if(previousPageNumber > 0)
                    {
                        <a asp-page="/ProductsListPage"
                        asp-route-parentCategory="@Model.ParentCategoryName"
                        asp-route-childCategory="@Model.ChildCategoryName"
                        asp-route-orderBy="@Model.CurrentOrderByOptions"
                        asp-route-pageNumber="@previousPageNumber"
                        class="navigation-button">
                            <img src="~/icons/left-arrow.svg" alt="left arrow" />
                        </a>
                    }
                    <div class="page-number-container">
                        <div class="page-number">@Model.CurrentPageNumber</div>
                    </div>
                    @if(Model.CurrentPageNumber < Model.MaxPageSize)
                    {
                        <a asp-page="/ProductsListPage"
                           asp-route-parentCategory="@Model.ParentCategoryName"
                           asp-route-childCategory="@Model.ChildCategoryName"
                           asp-route-orderBy="@Model.CurrentOrderByOptions"
                           asp-route-pageNumber="@nextPageNumber"
                           class="navigation-button">
                            <img src="~/icons/right-arrow.svg" alt="right arrow" />
                        </a>
                    }
                </div>
            </div>
        </div>
    </section>
</article>